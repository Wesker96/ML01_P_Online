
Аффинные преобразования — это такие преобразования, которые отображают плоскость или пространство в саму себя. [Статья](https://habr.com/ru/articles/539420/) на тему.

**Преобразование называется аффинным, если оно непрерывно, взаимно однозначно и образом любой прямой является прямая.**

Пусть у нас есть некоторая исходная система координат. Точка в этой системе определяется *x* и *y*. Тогда совершить переход к другой системе координат мы можем с помощью следующей системы уравнений:

![[Pasted image 20241209210659.png]]

Коэффициенты в системе уравнений образуют матрицу, причем эта матрица должна быть невырожденной, или ее определитель не должен быть равен нулю. Выбирая соответствующим образом коэффициенты в матрице мы можем обращать оси, сдвигать, вращать, масштабировать исходную систему координат.

*В комментария к этой статье, я обнаружил еще одну ссылку про аффинные преобразования на хабре: [ссылка](https://habr.com/ru/articles/463349/). Пока кажется сложной*

Построение аффинной матрицы на изображении основано на детекторе особых точек: детектор выдает особые точки с двух изображений, эти два списка фильтруются и сопоставляются, далее производится расчет матрицы. По ссылке выше можно найти пример расчет матрицы по заданным точкам.

Детекторов большое множество и среди них нет, главного. Точность алгоритмов зависит от угла поворота (я так понимаю между изображениями), чем больше поворот - меньше точность. В лекции в основном упоминаются алгоритмы SIFT и ORB. [Здесь](https://habr.com/ru/articles/414459/) упоминаются еще алгоритмы: "FAST, FAST-9, FAST-ER, BRIEF, rBRIEF, ORB".





Для декомпозиции матрицы использовать SVD (сингулярное разложение).

Датасет kitti


---
#### Домашнее задание

```
1) Для любых пар изображений которые имеют общее поле зрения (две фотографии сделанные с телефона который был повернут на определенный угол - любой лишь бы было 20+% перекрытия)
Рассчитать матрицу афинного преобразования из одной системы координат в другую. Выполнить разложение данной матрицы и посчитать явно угол поворота, вектор переноса и скалирования. 
Выполнить обратное преобразование - получить афинную матрицу заново. 

https://www.youtube.com/@Vaska_pilot/videos

2) Взять любую видеопоследовательность (желательно вид сверху) - например полет дрона. Можете скачать из  интернета или взять что то с работы. 
Зафиксировав точку (например центр экрана) выполнить стабилизацию данной точки с использованием матрицы афинного преобразования 
(считая матрицу между кадрами вы всегда сможете понять где именно находится точка на изображении, а по отклонению самой точки вы можете определить точность самого алгоритма).
Не берите 4к - долго считать, HD будет достаточно
Посчитать расстояние между точками и ошибку в пикселях.
Попробуйте добавить шум к изображению, посмотрите как меняется точность (положение точки). 
Добавьте фильтр к изображению для улучшения контрастности (любой который найдете).
Оцените как влияет выбор метода определения матрицы афинного преобразования - например estimateAffine2D и его аналоги (аналоги найдите самии).
Оцените как влияет выбор детектора/дескриптора особых точек на результат. Какой метод даст лучший и самый быстрый результат? 

3) LoFTR  - любой другой, сравнить с готовыми решениями. 

Напишите Вывод. 

```